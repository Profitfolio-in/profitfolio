<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sample Webpage</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        header, footer {
            background-color: #f2f2f2;
            padding: 10px;
            text-align: center;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            table-layout: auto;
            margin-top: 20px;
            cursor: pointer;
            background-color: #eff5ef;
            color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        table, th, td {
            border: 1px solid #f3eeee;
        }


        th, td {
            border: none;
            padding: 12px;
            text-align: center;
            white-space: nowrap;
            position: relative;
            background-color: #eff5ef;
            color: rgb(3, 2, 2);
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        th:hover,
        td:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(215, 24, 24, 0.2);
        }

        th:first-child,
        td:first-child,
        tr:first-child {
            background-color: #81e399; /* Highlight the first column */
        }
        tr:hover th,
        tr:hover td {
            background-color: #ffcc00; /* Change background color on hover */
            color: #333; /* Change text color on hover */
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        #row1 {
            background-color: #92bfec;
        }


    </style>
</head>

<body>
    <header>
        <h1>Rahav's Stock Portfolio</h1>
    </header>

    <div class="content">
        <table id = "tbl2">
            <tr><td id="row1"></td></tr>
            <tr><td id="row2"></td></tr>
            <tr><td id="row3"></td></tr>
        </table>
    </div>

    <main>
        <table id="data-table">
            <!-- JavaScript will populate this table -->
        </table>
    </main>

    <footer>
        <p></p>
    </footer>

    <script>

const gridOptions = {
    autoSizeStrategy: {
        type: 'fitGridWidth',
        defaultMinWidth: 100,
        columnLimits: [
            {
                colId: 'country',
                minWidth: 900
            }
        ]
    },

    // other grid options ...
}

        // Sample JavaScript to populate the table
        document.addEventListener('DOMContentLoaded', async function () {
            let n = await fetch("https://script.google.com/macros/s/AKfycbww26AkruYOb3fGAL03BF5z0oL07tmmPUcw9eCaK8e-mf-6qvUG3yrrmOtfk8aSQv-jUg/exec")
            let resp = await n.json()
            console.log(resp)

            //
            const row1 = document.getElementById('row1');
            row1.innerHTML = resp.data[29].name + " : Rs. " + resp.data[31].name
            const row2 = document.getElementById('row2');
            row2.innerHTML = resp.data[49].name + " : Rs. " + Math.round(resp.data[51].name) + "     ("+parseFloat((resp.data[51].name/resp.data[31].name)*100).toFixed(2)+ "%)"
            const row3 = document.getElementById('row3');
            row3.innerHTML = resp.data[69].name + " : Rs. " + Math.round(resp.data[71].name)
            console.log(resp.data[69].name + " : " + Math.round(resp.data[71].name))

            // Get the table element
            const table = document.getElementById('data-table');
            let r = 123;
            // Create 12 rows
            for (let i = 1; i <= 13; i++) {
                const row = table.insertRow();
                
                // Create 5 cells in each row
                for (let j = 1; j <= 9; j++) {
                    
                    console.log('Value of r :'+r)
                    const cell = row.insertCell();
                    // Sample data: Display row and column index in each cell
                    if(r==(124+((i-1)*20)) && r != 124 && (resp.data[r].name != null))
                        cell.textContent = 'Rs. '+resp.data[r].name;
                    else if(r==(125+((i-1)*20)) && r != 125 && (resp.data[r].name != null))
                        cell.textContent = resp.data[r].name.substr(2,8);
                    else if(r==(126+((i-1)*20)) && r != 126 && (resp.data[r].name != null))
                        cell.textContent = 'Rs. '+resp.data[r].name;
                    else if(r==(128+((i-1)*20)) && r != 128 && (resp.data[r].name != null))
                        cell.textContent = Math.round((resp.data[r].name*100))+" %";
                    else if(r==(131+((i-1)*20)) && r != 131 && (resp.data[r].name != null))
                        cell.textContent = "Rs. "+Math.round((resp.data[r].name));
                    else 
                        cell.textContent = resp.data[r].name;
                    
                    r=r+1;
                }
                r=r+11;
            }


        });
    </script>
</body>

</html>
